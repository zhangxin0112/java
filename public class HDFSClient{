public class HDFSClient{
	private FileSystem fs =null;

	public static synchronized FileSystem getFileSystem(){
		if(fs==null||checkfs()){
			Configuration conf = new Configuration();
			conf.addResource(new Path("conf/core-site.xml"));
			conf.addResource(new Path("conf/hdfs-site.xml"));
			conf.addResource(new Path("conf/mapreduce-site.xml"));
			conf.addResource(new Path("conf/hbase-site.xml"));
			fs=FileSystem.get(conf);
		}
		return fs;
	}
	public static synchronized boolean checkfs(){
		try{
			fs.exists(new Path("/"));
			return true;
		}catch(Exception e){
			e.printStackTrace();
		}
		return false;
	}
}